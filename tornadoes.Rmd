---
title: Analysis of 2018 tornado data from NOAA
author: Peter Carbonetto
output:
  html_document:
    theme: readable 
---

*Add brief summary of analysis here.*

```{r knitr-opts, include=FALSE}
knitr::opts_chunk$set(comment = "#",collapse = TRUE,results = "hold",
                      fig.align = "center",fig.height = 5,fig.width = 9)
```

# Load packages

Load the packages used in the analysis below.

```{r load-pkgs, message=FALSE, warning=FALSE}
library(readr)
library(ggplot2)
library(cowplot)
```

# Load tornado data

Load the 2018 storm event data from the CSV file. The data should be
stored in a data frame with 62,339 rows and 51 columns.

```{r load-data, message=FALSE, warning=FALSE}
storms <- read_csv("StormEvents_details-ftp_v1.0_d2018_c20190817.csv.gz")
class(storms) <- "data.frame"
nrow(storms)
ncol(storms)
```

Here we focus on events classified as tornadoes. We should find 1,250
tornado events.

```{r get-tornado-data}
tornadoes <- subset(storms,EVENT_TYPE == "Tornado")
nrow(tornadoes)
```

*Add text here.*

```{r summarize-f-scale}
tornadoes <- transform(tornadoes,TOR_F_SCALE = factor(TOR_F_SCALE))
summary(tornadoes$TOR_F_SCALE)
```

# Plot geographic distribution of tornadoes

*Add text here.*

```{r plot-tornadoes}
rows      <- order(tornadoes$TOR_F_SCALE)
tornadoes <- tornadoes[rows,]
ggplot(tornadoes,aes(x = BEGIN_LON,y = BEGIN_LAT,color = TOR_F_SCALE)) +
  geom_path(data = map_data("state"),aes(x = long,y = lat,group = group),
            color = "black") +
  geom_point(shape = 20,size = 4) +
  scale_color_manual(values = c("skyblue","dodgerblue","darkorange",
                                "magenta","gray")) +
  labs(x = "longitude",y = "latitude")
```
